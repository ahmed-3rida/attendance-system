# نظام إدارة حضور الطلاب

نظام إلكتروني لتسجيل حضور الطلاب باستخدام QR Code مع لوحة تحكم للأدمن لإنشاء المحاضرات والإحصائيات.

## المميزات

### لوحة تحكم الأدمن (`/admin`)
- تسجيل دخول آمن للأدمن
- إدارة المواد الدراسية
- إنشاء المحاضرات وتوليد QR Code لكل محاضرة
- عرض إحصائيات الحضور والغياب
- تصدير قوائم الحضور بصيغة Excel
- تتبع المحاولات الفاشلة للتسجيل
- إدارة الطلاب (عرض، تعديل، حذف)
- إدارة الإعدادات (تفعيل/تعطيل إدخال وتعديل بيانات الطلاب)

### واجهة الطلاب (`/`)
- مسح QR Code للمحاضرة
- إنشاء حساب أول مرة (إدخال البيانات)
- حفظ البيانات تلقائياً واستخدامها في المرات التالية
- عرض البروفايل وتعديل البيانات (إذا كان مسموح)
- تسجيل الحضور تلقائياً
- منع التسجيل المتكرر للمحاضرة الواحدة
- منع استخدام نفس الجهاز للتسجيل أكثر من مرة

## التقنيات المستخدمة

- **Backend**: Node.js + Express
- **Database**: SQLite
- **Frontend**: HTML5 + CSS3 + JavaScript + Bootstrap
- **QR Code**: HTML5-QRCode library
- **Excel Export**: XLSX library

## التثبيت والتشغيل

### المتطلبات
- Node.js (الإصدار 14 أو أحدث)
- npm

### خطوات التثبيت

1. **تثبيت المكتبات المطلوبة**:
```bash
npm install
```

2. **تشغيل الخادم**:
```bash
npm start
```

أو للتطوير مع إعادة التشغيل التلقائي:
```bash
npm run dev
```

3. **الوصول للنظام**:
- **الموقع الرئيسي للطلاب**: http://localhost:3000
- **لوحة تحكم الأدمن**: http://localhost:3000/admin

### بيانات الدخول الافتراضية للأدمن
- **اسم المستخدم**: admin
- **كلمة المرور**: admin123

## كيفية الاستخدام

### للأدمن (الدكتور):

1. **تسجيل الدخول**:
   - اذهب إلى `/admin`
   - أدخل بيانات الدخول

2. **إدارة المواد**:
   - اضغط على "إضافة مادة جديدة"
   - أدخل اسم المادة

3. **إنشاء المحاضرات**:
   - انتقل لتبويب "المحاضرات"
   - اختر المادة
   - اضغط "إضافة محاضرة جديدة"
   - أدخل تفاصيل المحاضرة

4. **عرض QR Code**:
   - اضغط "عرض QR Code" على أي محاضرة
   - اعرض QR Code للطلاب

5. **متابعة الحضور**:
   - انتقل لتبويب "الحضور"
   - اختر المحاضرة لعرض الإحصائيات
   - يمكن تصدير قائمة الحضور لـ Excel

6. **إدارة الطلاب**:
   - انتقل لتبويب "إدارة الطلاب"
   - عرض، تعديل، أو حذف بيانات الطلاب

7. **الإعدادات**:
   - انتقل لتبويب "الإعدادات"
   - فعّل/عطّل إدخال بيانات الطلاب
   - فعّل/عطّل تعديل بيانات الطلاب

### للطلاب:

1. **فتح الموقع**: http://localhost:3000
2. **إنشاء حساب أول مرة**: 
   - ستظهر نافذة لإنشاء حساب
   - أدخل الرقم الجامعي، الاسم، الجروب، والسكشن
3. **مسح QR Code**: وجه الكاميرا نحو QR Code الموجود في المحاضرة
4. **تسجيل الحضور**: اضغط "تسجيل الحضور" (البيانات تُملأ تلقائياً)

## هيكل المشروع

```
attend web/
├── server.js              # الخادم الرئيسي
├── package.json           # ملف التبعيات
├── admin/                 # لوحة تحكم الأدمن
│   ├── index.html
│   ├── admin.js
│   └── admin-enhanced.css
├── user/                  # واجهة الطلاب
│   ├── index.html
│   ├── user.js
│   └── user-enhanced.css
├── public/                # الملفات الثابتة
│   └── style.css
├── exports/               # ملفات Excel المصدرة (تُنشأ تلقائياً)
└── attendance.db          # قاعدة البيانات (تُنشأ تلقائياً)
```

## الأمان والميزات

### منع التلاعب:
- منع تسجيل الحضور أكثر من مرة للمحاضرة الواحدة
- منع استخدام نفس الجهاز (Session) للتسجيل أكثر من مرة
- تسجيل جميع المحاولات الفاشلة

### قاعدة البيانات:
- SQLite للسهولة والنقل
- جداول منفصلة للمواد، المحاضرات، الحضور، والمحاولات الفاشلة
- جدول `students` لحفظ بيانات الطلاب
- جدول `settings` للتحكم في الصلاحيات

### تصدير البيانات:
- تصدير قوائم الحضور بصيغة Excel
- تضمين وقت تسجيل الحضور بالضبط

## تخصيص النظام

### تغيير بيانات الأدمن:
بحث عن السطر في `server.js`:
```javascript
db.run("INSERT INTO admins (username, password) VALUES (?, ?)", ['admin', hashedPassword]);
```

### تخصيص المنظر:
عدّل ملفات CSS في مجلد `public/` والمجلدات الفرعية.

## استكشاف الأخطاء

### مشاكل الكاميرا:
- تأكد من السماح للمتصفح بالوصول للكاميرا
- جرب متصفحات مختلفة (Chrome, Firefox)

### مشاكل الاتصال:
- تأكد من تشغيل الخادم على البورت الصحيح
- تحقق من إعدادات الجدار الناري

## الدعم

في حالة وجود مشاكل أو استفسارات، يرجى مراجعة ملف `server.js` والإعدادات.

---

تم تطوير هذا النظام لتبسيط عملية تسجيل حضور الطلاب وتوفير إحصائيات دقيقة للأكاديميين.
